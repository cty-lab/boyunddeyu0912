<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å©šç¦®åº§ä½æŸ¥è©¢</title>
    <style>
        /* CSS æ¨£å¼ï¼šä¸»é¡Œé¡è‰²èˆ‡å­—é«”è¨­å®š */
        :root {
            --color-light-green: #CDE9B9;
            --color-dark-blue-gray: #6B7C95;
            --color-dark-green: #7D8E6F;
            --color-light-orange: #F2C3A7;
            --color-background-main: #F9F7F0;
            --color-text-dark: #333333;
            --color-text-light: #FFFFFF;
            --color-button-bg: var(--color-dark-green);
            --color-input-border: #B7C3D0; 
            --color-highlight-name: var(--color-dark-blue-gray);
            --color-result-found-bg: var(--color-light-green);
            --color-result-found-text: var(--color-dark-green);
        }

        body { 
            font-family: 'å¾®è»Ÿæ­£é»‘é«”', 'Arial', sans-serif;
            text-align: center; 
            padding: 20px 10px;
            background-color: var(--color-background-main);
            color: var(--color-text-dark);
            overflow-x: hidden; 
        }
        h1 { 
            color: var(--color-dark-blue-gray);
            margin-bottom: 40px;
            font-size: 1.8em;
        }
        input[type="text"] { 
            padding: 14px; 
            margin-bottom: 25px; 
            width: 90%; 
            max-width: 320px; 
            border: 2px solid var(--color-input-border);
            border-radius: 8px; 
            font-size: 1.1em;
            outline: none;
        }
        button { 
            padding: 14px 30px;
            background-color: var(--color-button-bg);
            color: var(--color-text-light);
            border: none; 
            border-radius: 8px;
            cursor: pointer; 
            font-size: 1.1em;
            transition: background-color 0.3s ease, transform 0.2s ease;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        button:hover:not(:disabled) { 
            background-color: #5D7A5B;
            transform: translateY(-2px);
        }
        button:disabled { 
            background-color: #AABFA9;
            cursor: wait;
        }
        
        /* === åœ–ç‰‡æ¨£å¼ï¼šé è¨­/é›»è…¦ç‰ˆå°ºå¯¸ (65%) === */
        .wedding-design-image {
            max-width: 65%; 
            height: auto; 
            margin-top: 40px; 
            margin-bottom: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.15);
        }
        
        #result { 
            margin-top: 30px; 
            padding: 25px;
            border: 2px solid #DCE0E6;
            border-radius: 12px;
            display: inline-block;
            width: 90%; 
            max-width: 400px;
            font-size: 1.2em;
            line-height: 1.6;
            background-color: var(--color-background-main);
            box-shadow: 0 6px 15px rgba(0,0,0,0.1);
            text-align: center;
        }
        .found { 
            background-color: var(--color-result-found-bg);
            color: var(--color-result-found-text);
            border-color: var(--color-result-found-text);
        } 
        .notFound { 
            background-color: var(--color-light-orange);
            color: #CC0000;
            border-color: #CC0000;
        } 
        .guest-name-highlight {
            color: var(--color-dark-blue-gray);
            font-weight: bold;
        }

        /* === åª’é«”æŸ¥è©¢ï¼šæ‰‹æ©Ÿç‰ˆå„ªåŒ– (å¯¬åº¦å°æ–¼ 768px æ™‚ï¼Œåœ–ç‰‡æ”¾å¤§) === */
        @media (max-width: 768px) {
            .wedding-design-image {
                max-width: 90%; /* æ‰‹æ©Ÿä¸Šåœ–ç‰‡æ”¾å¤§åˆ° 90% å¯¬åº¦ */
            }
        }
    </style>
</head>
<body>
    <h1>è˜‡æŸç‘œèˆ‡å¼µå¾·å¦¤çš„å©šç¦®</h1>
    <input type="text" id="guestName" placeholder="è«‹è¼¸å…¥å§“åæˆ–ç¨±è¬‚">
    
    <button onclick="searchSeat()" id="searchButton">æŸ¥è©¢åº§ä½</button>
    
    <div id="result">
        åœ¨é€™è£¡è¼¸å…¥å§“åï¼ŒæŸ¥è©¢æ‚¨çš„åº§ä½ã€‚
    </div>

    <img src="å©šç¦®åº§ä½è¡¨.jpg" alt="å©šç¦®è¨­è¨ˆä¸»é¡Œåœ–ç‰‡" class="wedding-design-image">

    <script>
        // ã€â­ Google Sheets é€£å‹•ï¼šæœ€çµ‚æ­£ç¢ºé€£çµ â­ã€‘
        const GOOGLE_SHEET_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRGD48WcMcPGkukcJyKEkA6vyl9TRBggoT0cAYqnXEDqqca1yftj9CFK1ChywRAng/pub?output=csv'; 
        
        let g_seatingChart = []; 

        // å‡½æ•¸ï¼šå¾ Google Sheets è¼‰å…¥è³‡æ–™ (è®€å– CSV)
        async function loadSeatingChart() {
            try {
                const response = await fetch(GOOGLE_SHEET_URL);
                const csvText = await response.text();
                
                // è§£æ CSV æ–‡æœ¬ï¼šè·³éæ¨™é¡Œè¡Œ
                const rows = csvText.split('\n').slice(1);
                
                return rows.map(row => {
                    const columns = row.split(',');
                    // å‡è¨­ A=å§“å (0), B=æ¡Œè™Ÿ (1), C=ç¨±è¬‚ (2)
                    const name = columns[0] ? columns[0].trim() : ''; 
                    const table = columns[1] ? columns[1].trim() : '';
                    const alias = columns[2] ? columns[2].trim() : '';

                    if (name && table) {
                        // è¿”å›åŒ…å«ç¨±è¬‚çš„ç‰©ä»¶
                        return { name: name, table: table, alias: alias };
                    }
                }).filter(item => item !== undefined);
                
            } catch (error) {
                document.getElementById("result").innerHTML = "ğŸš¨ è³‡æ–™è¼‰å…¥å¤±æ•—ï¼Œè«‹æª¢æŸ¥ç¶²è·¯æˆ– Google Sheets é€£çµã€‚";
                document.getElementById("result").className = "notFound";
                return []; 
            }
        }

        // æ‡‰ç”¨ç¨‹å¼åˆå§‹åŒ–ï¼šé é¢è¼‰å…¥æ™‚è‡ªå‹•åŸ·è¡Œ
        async function initApp() {
            const resultDiv = document.getElementById("result");
            const searchButton = document.getElementById("searchButton");
            
            searchButton.disabled = true;
            resultDiv.innerHTML = "è¼‰å…¥è³“å®¢åå–®ä¸­ï¼Œè«‹ç¨å€™..."; 
            resultDiv.className = "";

            g_seatingChart = await loadSeatingChart(); // è¼‰å…¥è³‡æ–™

            if (g_seatingChart.length > 0) {
                searchButton.disabled = false;
                resultDiv.innerHTML = "åœ¨é€™è£¡è¼¸å…¥å§“åï¼ŒæŸ¥è©¢æ‚¨çš„åº§ä½ã€‚"; 
            } else {
                searchButton.disabled = true;
                resultDiv.innerHTML = "ğŸš¨ å…§éƒ¨éŒ¯èª¤ï¼šè³‡æ–™è¼‰å…¥å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚";
                resultDiv.className = "notFound";
            }
        }
        
        // æœå°‹å‡½æ•¸ï¼šä½¿ç”¨å·²è¼‰å…¥çš„è³‡æ–™é€²è¡ŒåŒæ­¥æŸ¥è©¢ (ç„¡å½©è›‹)
        function searchSeat() {
            const guestNameInput = document.getElementById("guestName").value;
            const cleanedName = guestNameInput.trim(); 

            const resultDiv = document.getElementById("result");

            resultDiv.style.display = 'inline-block';

            if (cleanedName === "") {
                resultDiv.innerHTML = "å—¨å—¨~è«‹è¼¸å…¥æœ¬åæˆ–ç¨±è¬‚æ‰èƒ½æ‰¾åˆ°ä½ å–”ï¼";
                resultDiv.className = "notFound";
                return;
            }
            
            // å°‡è¼¸å…¥è½‰ç‚ºå°å¯«ï¼Œæ–¹ä¾¿æ¨¡ç³Šæœå°‹
            const searchKey = cleanedName.toLowerCase();

            // æœå°‹é‚è¼¯ï¼šæª¢æŸ¥å§“å AND æª¢æŸ¥ç¨±è¬‚ (æ¨¡ç³ŠåŒ…å«)
            const foundGuest = g_seatingChart.find(guest => 
                // 1. æª¢æŸ¥å§“åæ˜¯å¦å®Œå…¨åŒ¹é…
                guest.name.toLowerCase() === searchKey ||
                // 2. æª¢æŸ¥ç¨±è¬‚æ¬„ä½æ˜¯å¦åŒ…å«æœå°‹çš„é—œéµè© (æ¨¡ç³Šæœå°‹)
                guest.alias.toLowerCase().includes(searchKey)
            );

            if (foundGuest) {
                resultDiv.innerHTML = `<span class="guest-name-highlight">${foundGuest.name}</span>ï¼Œæ­¡è¿ä¾†åˆ°æˆ‘å€‘çš„å©šç¦®â¤ï¸<br>æ‚¨çš„æ¡Œè™Ÿæ˜¯ï¼š<strong>${foundGuest.table}</strong>`;
                resultDiv.className = "found";
            } else {
                resultDiv.innerHTML = "å—¨å—¨~è«‹è¼¸å…¥æœ¬åæˆ–ç¨±è¬‚æ‰èƒ½æ‰¾åˆ°ä½ å–”ï¼";
                resultDiv.className = "notFound";
            }
        }

        // é é¢è¼‰å…¥å®Œæˆå¾Œï¼Œå•Ÿå‹•æ‡‰ç”¨ç¨‹å¼åˆå§‹åŒ–
        window.onload = initApp;
    </script>
</body>
</html>
