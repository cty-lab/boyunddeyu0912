<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å©šç¦®åº§ä½æŸ¥è©¢</title>
    <style>
        /* === é—œéµä¿®æ­£ï¼šç¢ºä¿å¯¬åº¦è¨ˆç®—ä¸æœƒæº¢å‡ºï¼Œè§£æ±ºè·‘ç‰ˆå•é¡Œ === */
        *, *::before, *::after {
            box-sizing: border-box;
        }
        /* ================================================= */

        /* CSS æ¨£å¼ï¼šä¸»é¡Œé¡è‰²èˆ‡å­—é«”è¨­å®š */
        :root {
            --color-light-green: #CDE9B9;
            --color-dark-blue-gray: #6B7C95;
            --color-dark-green: #7D8E6F;
            --color-light-orange: #F2C3A7;
            --color-background-main: #F9F7F0;
            --color-text-dark: #333333;
            --color-text-light: #FFFFFF;
            --color-button-bg: var(--color-dark-green);
            --color-input-border: #B7C3D0; 
            --color-highlight-name: var(--color-dark-blue-gray);
            --color-result-found-bg: var(--color-light-green);
            --color-result-found-text: var(--color-dark-green);
        }

        /* === Body æ¡ç”¨ Flexbox ä½ˆå±€ï¼šç¢ºä¿å…§å®¹æ°´å¹³å±…ä¸­ === */
        body { 
            font-family: 'å¾®è»Ÿæ­£é»‘é«”', 'Arial', sans-serif;
            margin: 0; 
            background-color: var(--color-background-main);
            color: var(--color-text-dark);
            /* ç§»é™¤ overflow-x: hidden; ä»¥é˜² Flexbox è¢«éŒ¯èª¤å½±éŸ¿ï¼Œè®“ Flexbox è‡ªè¡Œè™•ç† */
            min-height: 100vh; 
            display: flex;
            justify-content: center; /* æ°´å¹³å±…ä¸­ */
            align-items: flex-start;
            text-align: initial; 
        }

        /* å…§å®¹åŒ…è£å™¨ï¼šFlexbox æœƒå°‡é€™å€‹ div æ”¾åœ¨ç•«é¢ä¸­å¤® */
        #app-wrapper {
            width: 100%;
            max-width: 500px;
            padding: 20px 10px; 
            text-align: center; 
        }

        h1 { 
            color: var(--color-dark-blue-gray);
            margin-bottom: 40px;
            font-size: 2.16em; 
        }
        
        /* è¼¸å…¥æ¬„ä½ï¼šç¢ºä¿ç½®ä¸­ */
        input[type="text"] { 
            padding: 16px; 
            margin: 0 auto 25px auto; 
            display: block; 
            width: 90%; 
            max-width: 368px; 
            border: 2px solid var(--color-input-border);
            border-radius: 8px; 
            font-size: 1.25em; 
            outline: none;
        }
        
        button { 
            padding: 16px 35px; 
            background-color: var(--color-button-bg);
            color: var(--color-text-light);
            border: none; 
            border-radius: 8px;
            cursor: pointer; 
            font-size: 1.25em; 
            transition: background-color 0.3s ease, transform 0.2s ease;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        button:hover:not(:disabled) { 
            background-color: #5D7A5B;
            transform: translateY(-2px);
        }
        button:disabled { 
            background-color: #AABFA9;
            cursor: wait;
        }
        
        /* === åœ–ç‰‡æ¨£å¼ï¼šç¢ºä¿ç½®ä¸­ä¸¦éŸ¿æ‡‰å¼ === */
        .wedding-design-image {
            max-width: 80%; 
            height: auto; 
            margin: 40px auto 20px auto; 
            display: block;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.15);
        }
        
        /* === çµæœæ¡†ï¼šä½¿ç”¨ margin: auto ç½®ä¸­ï¼Œå…§éƒ¨æ–‡å­—é å·¦ === */
        #result { 
            margin: 30px auto 0 auto; 
            padding: 25px;
            border: 2px solid #DCE0E6;
            border-radius: 12px;
            display: block; 
            width: 90%; 
            max-width: 400px;
            font-size: 1.2em;
            line-height: 1.6;
            background-color: var(--color-background-main);
            box-shadow: 0 6px 15px rgba(0,0,0,0.1);
            text-align: left; /* ä¿æŒæ¡†å…§æ–‡å­—é å·¦å°é½Š */
        }
        
        .found { background-color: var(--color-result-found-bg); color: var(--color-result-found-text); border-color: var(--color-result-found-text); } 
        .notFound { background-color: var(--color-light-orange); color: #CC0000; border-color: #CC0000; } 
        .guest-name-highlight { color: var(--color-dark-blue-gray); font-weight: bold; }

        /* === åª’é«”æŸ¥è©¢ï¼šæ‰‹æ©Ÿç‰ˆåœ–ç‰‡æ”¾å¤§å„ªåŒ– === */
        @media (max-width: 768px) {
            .wedding-design-image {
                max-width: 100%; 
            }
        }
    </style>
</head>
<body>
    <div id="app-wrapper">
        <h1>è˜‡æŸç‘œèˆ‡å¼µå¾·å¦¤çš„å©šç¦®</h1>
        <input type="text" id="guestName" placeholder="è«‹è¼¸å…¥å§“åæˆ–ç¨±è¬‚">
        
        <button onclick="searchSeat()" id="searchButton">æŸ¥è©¢åº§ä½</button>
        
        <div id="result">
            åœ¨é€™è£¡è¼¸å…¥å§“åï¼ŒæŸ¥è©¢æ‚¨çš„åº§ä½ã€‚
        </div>

        <img src="å©šç¦®åº§ä½è¡¨.jpg" alt="å©šç¦®è¨­è¨ˆä¸»é¡Œåœ–ç‰‡" class="wedding-design-image">
    </div>
    <script>
        // ã€â­ Google Sheets é€£å‹•ï¼šæœ€çµ‚æ­£ç¢ºé€£çµ â­ã€‘
        const GOOGLE_SHEET_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRGD48WcMcPGkukcJyKEkA6vyl9TRBggoT0cAYqnXEDqqca1yftj9CFK1ChywRAng/pub?output=csv'; 
        
        let g_seatingChart = []; 

        async function loadSeatingChart() {
            try {
                const response = await fetch(GOOGLE_SHEET_URL);
                const csvText = await response.text();
                
                const rows = csvText.split('\n').slice(1);
                
                return rows.map(row => {
                    const columns = row.split(',');
                    const name = columns[0] ? columns[0].trim() : ''; 
                    const table = columns[1] ? columns[1].trim() : '';
                    const alias = columns[2] ? columns[2].trim() : '';

                    if (name && table) {
                        return { name: name, table: table, alias: alias };
                    }
                }).filter(item => item !== undefined);
                
            } catch (error) {
                document.getElementById("result").innerHTML = "ğŸš¨ è³‡æ–™è¼‰å…¥å¤±æ•—ï¼Œè«‹æª¢æŸ¥ç¶²è·¯æˆ– Google Sheets é€£çµã€‚";
                document.getElementById("result").className = "notFound";
                return []; 
            }
        }

        async function initApp() {
            const resultDiv = document.getElementById("result");
            const searchButton = document.getElementById("searchButton");
            
            searchButton.disabled = true;
            resultDiv.innerHTML = "è¼‰å…¥è³“å®¢åå–®ä¸­ï¼Œè«‹ç¨å€™..."; 
            resultDiv.className = "";

            g_seatingChart = await loadSeatingChart(); 

            if (g_seatingChart.length > 0) {
                searchButton.disabled = false;
                resultDiv.innerHTML = "åœ¨é€™è£¡è¼¸å…¥å§“åï¼ŒæŸ¥è©¢æ‚¨çš„åº§ä½ã€‚"; 
            } else {
                searchButton.disabled = true;
                resultDiv.innerHTML = "ğŸš¨ å…§éƒ¨éŒ¯èª¤ï¼šè³‡æ–™è¼‰å…¥å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚";
                resultDiv.className = "notFound";
            }
        }
        
        function searchSeat() {
            const guestNameInput = document.getElementById("guestName").value;
            const cleanedName = guestNameInput.trim(); 

            const resultDiv = document.getElementById("result");

            resultDiv.style.display = 'inline-block';

            if (cleanedName === "") {
                resultDiv.innerHTML = "å—¨å—¨~è«‹è¼¸å…¥æœ¬åæˆ–ç¨±è¬‚æ‰èƒ½æ‰¾åˆ°ä½ å–”ï¼";
                resultDiv.className = "notFound";
                return;
            }
            
            const searchKey = cleanedName.toLowerCase();

            const foundGuest = g_seatingChart.find(guest => 
                guest.name.toLowerCase() === searchKey ||
                guest.alias.toLowerCase().includes(searchKey)
            );

            if (foundGuest) {
                resultDiv.innerHTML = `<span class="guest-name-highlight">${foundGuest.name}</span>ï¼Œæ­¡è¿ä¾†åˆ°æˆ‘å€‘çš„å©šç¦®â¤ï¸<br>æ‚¨çš„æ¡Œè™Ÿæ˜¯ï¼š<strong>${foundGuest.table}</strong>`;
                resultDiv.className = "found";
            } else {
                resultDiv.innerHTML = "å—¨å—¨~è«‹è¼¸å…¥æœ¬åæˆ–ç¨±è¬‚æ‰èƒ½æ‰¾åˆ°ä½ å–”ï¼";
                resultDiv.className = "notFound";
            }
        }

        window.onload = initApp;
    </script>
</body>
</html>
